services:
  web:
    build: .
    extra_hosts:
      - "host.docker.internal:host-gateway"
    environment:
      - DATABASE_URL=${DATABASE_URL}
      - APP_BASIC_AUTH_USER=${APP_BASIC_AUTH_USER}
      - APP_BASIC_AUTH_PASS=${APP_BASIC_AUTH_PASS}
      - APP_TIMEZONE=${APP_TIMEZONE:-Asia/Shanghai}
      - USER_HEIGHT_CM=${USER_HEIGHT_CM:-170}
      - GOAL_WEIGHT_KG=${GOAL_WEIGHT_KG:-80}
      - UPLOAD_DIR=${UPLOAD_DIR:-storage/uploads}
      - MAX_UPLOAD_MB=${MAX_UPLOAD_MB:-10}
    volumes:
      - ./storage:/app/storage
    ports:
      - "8000:8000"
